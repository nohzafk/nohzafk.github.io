{{- $projects := sort .Pages "Params.weight" -}}
{{- $totalProjects := len $projects -}}
{{- $contributorCount := 0 -}}
{{- $uniqueTags := slice -}}
{{- range $projects -}}
    {{- if .Params.contributor -}}
        {{- $contributorCount = add $contributorCount 1 -}}
    {{- end -}}
    {{- range .Params.tags -}}
        {{- if not (in $uniqueTags .) -}}
            {{- $uniqueTags = $uniqueTags | append . -}}
        {{- end -}}
    {{- end -}}
{{- end -}}

<div class="projects-container">
    <div class="hud-frame">
        <div class="hud-corner top-left">┌─</div>
        <div class="hud-label">Projects</div>
        <div class="hud-corner top-right">─┐</div>
    </div>

    <div class="terminal-header">
        <span class="terminal-prompt">ls -la</span>
        <span class="terminal-path">~/projects/</span>
    </div>

    <ul class="project-list">
        {{- range $index, $project := $projects -}}
        <li class="project-item"{{ if $project.Params.repo }} onclick="window.location.href='{{ $project.Params.repo }}'"{{ end }}>
            <span class="project-prefix">►</span>
            <span class="project-name">{{ $project.Title }}</span>
            <div class="project-meta">
                <div class="project-tags">
                    {{- range $project.Params.tags -}}
                    <span class="project-tag">{{ . }}</span>
                    {{- end -}}
                    {{- if $project.Params.contributor -}}
                    <span class="project-tag contributor-badge">contrib</span>
                    {{- end -}}
                </div>
            </div>
            <p class="project-description">{{ $project.Description }}</p>
        </li>
        {{- end -}}
    </ul>

    <div class="terminal-footer">
        <span class="stat-item">
            total <span class="stat-value">{{ $totalProjects }}</span> projects
        </span>
        <span class="stat-item">
            <span class="stat-value">{{ $contributorCount }}</span> contributions
        </span>
        <span class="stat-item">
            <span class="stat-value">{{ len $uniqueTags }}</span> tags
        </span>
    </div>

    <div class="hud-frame bottom">
        <div class="hud-corner bottom-left">└─</div>
        <div class="hud-corner bottom-right">─┘</div>
    </div>
</div>
